<!DOCTYPE html>
<html>

  <head>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <title>Dispersal Kernels and Isolation-by-Distance</title>
  <meta name="description" content="The effect of the dispersal kernel on isolation-by-distance in a continuous populationTara N. Furstenau and Reed A. Cartwright">
  
  <meta name="author" content="Tara Furstenau">
  <meta name="copyright" content="&copy; Tara Furstenau 2015">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/monokai_sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

	<!-- Facebook OGP cards -->
  <meta property="og:description" content="The effect of the dispersal kernel on isolation-by-distance in a continuous populationTara N. Furstenau and Reed A. Cartwright" />
  <meta property="og:url" content="http://tfursten.github.io" />
  <meta property="og:site_name" content="Tara Furstenau" />
  <meta property="og:title" content="Dispersal Kernels and Isolation-by-Distance" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://tfursten.github.io/centrarium/assets/logo.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />

  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Dispersal Kernels and Isolation-by-Distance">
  <meta name="twitter:description" content="The effect of the dispersal kernel on isolation-by-distance in a continuous populationTara N. Furstenau and Reed A. Cartwright">
  <meta name="twitter:image" content="http://tfursten.github.io/centrarium/assets/logo.png">
  <meta name="twitter:url" content="http://tfursten.github.io">

  

	<!-- Site styles -->
  <link rel="stylesheet" href="/centrarium/css/main.css">
  <link rel="canonical" href="http://tfursten.github.io/centrarium//research/2015/09/01/IBD.html">
  <link rel="alternate" type="application/rss+xml" title="Tara Furstenau" href="http://tfursten.github.io/centrarium//feed.xml" />
  <!-- Bootstrap -->


</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/centrarium/" class="logo">
    	
      <img src="/centrarium/assets/logo.png" alt="Tara Furstenau">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
    	<i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
      	
          
          <li class="nav-link"><a href="/centrarium/about/">About</a>
          
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/centrarium/posts/">Posts</a>
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/centrarium/assets/header_image.jpg);">
	<div class="scrim has-cover">
		<header class="post-header">
		  <h1 class="title">Dispersal Kernels and Isolation-by-Distance</h1>
		  <p class="info">by <strong>Tara Furstenau</strong></p>
		</header>
	</div>
</div>

<div class="wrapper">



<section class="post-meta">
	<div class="post-date">September 1, 2015</div>
	<div class="post-categories">
	in 
	  
	  <span>Research</span>
	  
	
	</div>
</section>	

<article class="post-content">
  <h1 id="the-effect-of-the-dispersal-kernel-on-isolation-by-distance-in-a-continuous-population">The effect of the dispersal kernel on isolation-by-distance in a continuous population</h1>
<p>Tara N. Furstenau and Reed A. Cartwright</p>

<h2 id="abstract">Abstract</h2>
<p>Under models of isolation-by-distance, population structure is determined by the probability of identity-by-descent between pairs of genes according to the geographic distance between them. Well established analytical results indicate that the relationship between geographical and genetic distance depends mostly on the neighborhood size of the population, <script type="math/tex">N_b=4\pi\sigma2D_e</script>, which represents a standardized measure of dispersal. To test this prediction, we model local dispersal of haploid individuals on a two-dimensional torus using four dispersal kernels: Rayleigh, exponential, half-normal and triangular. When neighborhood size is held constant, the distributions produce similar patterns of isolation-by-distance, confirming predictions. Considering this, we propose that the triangular distribution is the appropriate null distribution for isolation-by-distance studies. Under the triangular distribution, dispersal is uniform within an area of 4πσ2 (i.e. the neighborhood area), which suggests that the common description of neighborhood size as a measure of a local panmictic population is valid for popular families of dispersal distributions. We further show how to draw from the triangular distribution efficiently and argue that it should be utilized in other studies in which computational efficiency is important<br />
<a href="http://arxiv.org/pdf/1501.01085v1.pdf">arXiv</a><br />
<a href="https://github.com/tfursten/IBD">github</a></p>

<h2 id="simulation-description">Simulation Description</h2>
<p>In the simulation, a population exists on a <script type="math/tex">N \times N</script> rectangular lattice with either periodic boundaries (a torus) or absorbing boundaries. Individuals are uniformly distributed on the lattice with a single individual per node. Individuals are haploid and contain a single neutral genetic locus.</p>

<p>In the initial generation, the population contains the maximum number of individuals allowed by the landscape and each individual is assigned a unique allele (represented by an integer). During each discrete generation cycle, individuals reproduce by producing a number of clonal offspring.  These offspring experience mutations according to the infinite alleles model at rate <script type="math/tex">\mu</script>.  A burn-in period may be set to allow the population to reach a drift/mutation equilibrium.</p>

<p>The offspring disperse from their original cell according to a set dispersal distribution.  As offspring land on their destination cell they are immediately accepted or rejected using a reservoir sampling method, which allows the offspring to be uniformly sampled at each location as they arrive instead of storing them all in memory <a href="http://www.cs.umd.edu/~samir/498/vitter.pdf">(Vitter, 1985)</a>.  When dispersal is complete, there is a maximum of one offspring per cell and that offspring becomes a parent in the next generation.</p>

<p>There are currently 9 different dispersal distributions: exponential, gamma, half-normal, Pareto, Rayleigh, Rice, ring, and uniform. Some distributions have two implementations where one version is faster than the other.  The faster version is used by setting the <code>--fast</code> flag to true which is default. All uniform pseudo-random numbers are generated using an efficient xorshift algorithm <a href="http://www.jstatsoft.org/v08/i14/">(Marsaglia 2003)</a>.</p>

<h3 id="exponential">Exponential</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Exponential_distribution">exponential</a> dispersal function takes a single argument (<script type="math/tex">\sigma</script>) and returns polar coordinates with exponentially distributed distances with rate <script type="math/tex">\frac{1}{\sigma}</script> and a uniform angle.  The distance values are drawn using an implementation of the ziggurat rejection sampling algorithm for the exponential distribution <a href="http://www.jstatsoft.org/v05/i08/paper/">(Marsaglia and Tsang, 2000)</a>.</p>

<h3 id="gamma">Gamma</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Gamma_distribution">gamma</a> dispersal function takes two arguments, <script type="math/tex">\sigma</script> and <script type="math/tex">\alpha</script>, and the <script type="math/tex">\beta</script> parameter is calculated so that the second moment of the distribution is equal to <script type="math/tex">2\sigma^2</script>. This function returns polar coordinates with gamma distributed distances and a uniform angle. The distance values are generated using <a href="http://dl.acm.org/citation.cfm?id=358414">Marsaglia’s (2000)</a> rejection sampling algorithm which takes advantage of the fast ziggurat procedure for generating normally distributed PRNs <a href="http://www.jstatsoft.org/v05/i08/paper/">(Marsaglia and Tsang, 2000)</a>.</p>

<h3 id="half-normal">Half-Normal</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Half-normal_distribution">half-normal</a> dispersal function takes a single argument, <script type="math/tex">\sigma</script>, and returns polar coordinates with half-normal distributed distances with variance parameter <script type="math/tex">\sigma\sqrt{2}</script> and a uniform angle. The distance values are the absolute value of draws from a normal distribution using an implementation of the ziggurat rejection sampling algorithm <a href="http://www.jstatsoft.org/v05/i08/paper/">(Marsaglia and Tsang, 2000)</a>.</p>

<h3 id="pareto">Pareto</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Pareto_distribution">Pareto</a> distribution is a mixture of exponential distributions with a gamma mixing distribution. The Pareto dispersal function takes two arguments, <script type="math/tex">\sigma</script> and <script type="math/tex">\alpha</script> and the <script type="math/tex">X_{min}</script> parameter is calculated so that the second moment of the distribution is equal to <script type="math/tex">2\sigma^2</script>. The function returns polar coordinates with Pareto distributed distances and a uniform angle. The distance values are generated using inverse transform sampling, which, due to the relationship between the Pareto and exponential distributions, takes advantage of the fast ziggurat procedure for generating exponentially distributed PRNs <a href="http://www.jstatsoft.org/v05/i08/paper/">(Marsaglia and Tsang, 2000)</a>.</p>

<h3 id="lomax">Lomax</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Lomax_distribution">Lomax</a> distribution or Pareto Type II distribution is essentially a Pareto distribution that has been shifted so that its support begins at zero.  It takes two arguments, <script type="math/tex">\sigma</script> and <script type="math/tex">\alpha</script> and the scale parameter is calculated so that the second moment of the distribution is equal to <script type="math/tex">2\sigma^2</script>.  The function returns polar coordinates with Lomax  distributed distances and a uniform angle.  The distances are generated by subtracting Xmin from the Pareto dispersal function.</p>

<h3 id="rayleigh">Rayleigh</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Rayleigh_distribution">Rayleigh</a> dispersal function may take one or two arguments, <script type="math/tex">\sigma_x</script> and <script type="math/tex">\sigma_y</script>.  If only a single argument is given, <script type="math/tex">\sigma</script> will be the same for each dimension and result in an isometric 2-dimensional normal distribution.  For the sake of uniformity, this was called the Rayleigh dispersal function because it originally returned polar coordinates with Rayleigh distributed distances and a uniform angle; however, this required an inefficient conversion from polar to Cartesian coordinates. We instead draw axial offset distances from a normal distribution with variance <script type="math/tex">\sigma_x^2</script> (or <script type="math/tex">\sigma_y^2</script>) using an implementation of the ziggurat rejection sampling algorithm <a href="http://www.jstatsoft.org/v05/i08/paper/">(Marsaglia and Tsang, 2000)</a>.  There is a “fast” version of this dispersal function available which precalculates the probability of dispersing on a discrete lattice.  Once the dispersal probabilities are calculated we use the efficient Alias method to sample from this discrete probability distribution <a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=92917">(Vose, 1991)</a>.</p>

<h3 id="rice">Rice</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Rice_distribution">Rice</a> dispersal function takes two arguments, <script type="math/tex">\sigma</script> and <script type="math/tex">angle</script>.  This distribution results in an isometric 2-dimensional normal distribution where the mean has shifted away from the origin to a polar coordinate (<script type="math/tex">v,angle</script>). The <script type="math/tex">v</script> parameter is calculated so that the second moment of the distribution is equal to <script type="math/tex">2\sigma^2</script>.  Axial distances are drawn from two normal distributions with means <script type="math/tex">v\cos(angle)</script> and <script type="math/tex">v\sin(angle)</script> and variance <script type="math/tex">\sigma^2</script> using an implementation of the ziggurat rejection sampling algorithm <a href="http://www.jstatsoft.org/v05/i08/paper/">(Marsaglia and Tsang,2000)</a>.</p>

<h3 id="ring">Ring</h3>
<p>The <a href="https://github.com/tfursten/Ring">ring</a> dispersal function takes two arguments, <script type="math/tex">\sigma</script> and <script type="math/tex">p</script>.  This distribution returns a polar coordinates with a constant distance <script type="math/tex">\sigma</script> and a uniform angle. The <script type="math/tex">p</script> parameter determines the probability of not dispersing away from the origin.  There is a fast version of this dispersal function available which precalcuates the probability of dispersing on a discrete lattice.  Once the dispersal probabilities are calculated we use the efficient Alias method to sample from this discrete probability distribution <a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=92917">(Vose, 1991)</a></p>

<h3 id="triangular">Triangular</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Triangular_distribution">triangular</a> dispersal function takes a single argument, <script type="math/tex">\sigma</script>, and returns polar coordinates with triangular distributed distance with <script type="math/tex">a=0</script>, <script type="math/tex">b=c=2\sigma</script>, and a uniform angle. The distance values are generated using inverse transform sampling.  There is a fast version of this dispersal function available which precalcuates the probability of dispersing on a discrete lattice.  Once the dispersal probabilities are calculated we use the efficient Alias method to sample from this discrete probability distribution <a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=92917">(Vose, 1991)</a>.</p>

<h3 id="uniform">Uniform</h3>
<p>The uniform dispersal function takes two arguments, the <script type="math/tex">x</script> and <script type="math/tex">y</script> dimensions of the landscape.  It returns new coordinates anywhere on the landscape with uniform probability.</p>

<h2 id="compiling-from-source-code">Compiling from Source Code</h2>
<p>IBD requires <a href="http://www.cmake.org/">CMake 2.8</a> to build from source.</p>

<ol>
  <li>Download the source code.</li>
  <li>Decompress the tar-bzip archive<br />
  <code>
  tar xvzf IBD-*.tar.bz2
 </code></li>
  <li>Change to the build directory.<br />
  <code>
  cd IBD-*/build
 </code></li>
  <li>Run the CMake build system.<br />
  <code>
  cmake ..
 </code></li>
  <li>Compile<br />
  <code>
  make
 </code></li>
</ol>

<h2 id="dependencies">Dependencies</h2>
<p>The Boost c++ Library is required for compilation and usage.</p>

<ul>
  <li>Foreach</li>
  <li>Program Options</li>
</ul>

<h2 id="run">Run</h2>
<p>Usage:</p>

<pre><code>$ ./ibd config.txt
$ ./ibd --help
Allowed Options:

General Options:
  --help                Produce help message

Configuration:
  -x [ --maxX ] arg (=100)              Set X dimension
  -y [ --maxY ] arg (=100)              Set Y dimension
  -g [ --generations ] arg (=10)        Set number of Generations to run after 
                                        burn-in
  -o [ --offspring ] arg (=10)          Set number of offspring per individual
  -m [ --mut ] arg (=0)                 Set mutation rate
  -d [ --distribution ] arg (=triangular)
                                        Set Dispersal Distribution
  -s [ --sigma ] arg (=2)               Set dispersal parameter
  -b [ --burn ] arg (=0)                Set Burn-in Period
  -t [ --sample ] arg (=1)              Sample every n generations after 
                                        burn-in
  -f [ --output_file ] arg (=data)      Output File Name
  --seed arg (=0)                       Set PRNG seed, 0 to create random seed
  --landscape arg (=torus)              Set boundary conditions: torus or 
                                        rectangular
  --transect arg (=0)                   Set position of transect in X axis.
  --verbose arg (=0)                    Print data to screen
  --sparam arg (=0)                     Extra Parameter for dispersal
  --fast arg (=1)                       Use fast dispersal when available
</code></pre>


</article>



<section class="rss">
	<p class="rss-subscribe text"><strong>Subscribe <a href="/centrarium/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
      <a href="http://twitter.com/share?text=Dispersal+Kernels+and+Isolation-by-Distance&amp;url=http://tfursten.github.io/research/2015/09/01/IBD.html"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
      	<i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
  
    
      <a href="//www.facebook.com/sharer.php?t=Dispersal+Kernels+and+Isolation-by-Distance&amp;u=http://tfursten.github.io/research/2015/09/01/IBD.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
      	<i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
  
    
  
    
      <a href="//www.linkedin.com/shareArticle?mini=trueDispersal+Kernels+and+Isolation-by-Distance&amp;url=http://tfursten.github.io/research/2015/09/01/IBD.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
      	<i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
  
    
      <a href="//plus.google.com/share?title=Dispersal+Kernels+and+Isolation-by-Distance&amp;url=http://tfursten.github.io/research/2015/09/01/IBD.html"
        onclick="window.open(this.href, 'google-plus-share', 'width=550,height=255');return false;">
      	<i class="fa fa-google-plus-square fa-lg"></i>
      </a>
    
  
</section>



<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'bencentra';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">Tara Furstenau</h3>

    <div class="site-navigation">
    	
    	<p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/centrarium/about/">About</a>
        
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/centrarium/posts/">Posts</a>
        
        
      </ul>
    </div>

    <div class="site-contact">

    	<p><strong>Contact</strong>
      <ul class="social-media-list">
      	<li>
      		<a href="mailto:tarafurstenau@gmail.com">
	      		<i class="fa fa-envelope-o"></i>
	      		<span class="username">tarafurstenau@gmail.com</span>
      		</a>
      	</li>

      	
      	
      	<li>
          <a href="https://twitter.com/tara_furstenau" title="Follow me on Twitter">
            <i class="fa fa-twitter"></i>
            <span class="username">@tara_furstenau</span>
          </a>
        </li>
      	
      	
      	
      	<li>
          <a href="https://www.facebook.com/tara.furstenau" title="Friend me on Facebook">
            <i class="fa fa-facebook"></i>
            <span class="username">TaraFurstenau</span>
          </a>
        </li>
      	
      	
      	
      	<li>
          <a href="https://github.com/tfursten" title="Fork me on GitHub">
            <i class="fa fa-github"></i>
            <span class="username">tfursten</span>
          </a>
        </li>
      	
      	
      	
      	<li>
          <a href="http://www.linkedin.com/pub/tara-furstenau/74/b3/491" title="Connect with me on LinkedIn">
            <i class="fa fa-linkedin"></i>
            <span class="username">TaraFurstenau</span>
          </a>
        </li>
      	
      	
      	
      	<li>
          <a href="https://plus.google.com/u/1/+TaraFurstenau/about" title="Add me to your Circles">
            <i class="fa fa-google-plus"></i>
            <span class="username">TaraFurstenau</span>
          </a>
        </li>
      	
      	

      </ul>
    </div>

    <div class="site-signature">
    	<p class="rss-subscribe text"><strong>Subscribe <a href="/centrarium/feed.xml">via RSS</a></strong></p>
      <p class="text"></p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>
<script>

$(document).ready(function() {

	// Syntax highlighting
	hljs.initHighlightingOnLoad();

	// Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });


});

</script>




  </body>

</html>
